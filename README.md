# SilverSurfer: A Wavelet-Based Deep Learning Architecture for Magnetic Switchback Detection

**SilverSurfer** is a Deep Learning framework designed to detect Magnetic Switchbacks (rapid polarity reversals) in solar wind data collected by NASA's *Parker Solar Probe (PSP)*.

Unlike traditional threshold-based algorithms, SilverSurfer uses a Physics-Informed CNN that analyzes the Alfvenicity (correlation between Magnetic Field $B$ and Plasma Velocity $V$) to identify events. This allows it to detect a "Hidden Population" of switchbacks that standard thresholding catalogs miss.

## Key Features
*   **Physics-Informed:** Learns the $B \propto V$ relationship, robust against noise.
*   **Multi-Scale:** Uses Ricker and Haar Wavelets to see structures at multiple resolutions.
*   **Morphological Invariance:** Proven to generalize from Encounter 2 (Reference) to Encounter 6 (Solar Maximum) with minimal fine-tuning.
*   **Universal Clock:** Auto-syncs data to 14.5 Hz regardless of the original instrument sampling rate.

## Installation

1.  Clone the repository:
    ```bash
    git clone https://github.com/OliverAltindag/SilverSurfer.git
    cd SilverSurfer
    ```

2.  Install dependencies:
    ```bash
    pip install -r requirements.txt
    ```

## Data Requirements
Place your `.cdf` files (PSP FIELDS and SWEAP L2/L3 data) in a `Data/` folder.
*   **L2 MAG:** `psp_fld_l2_mag_RTN_...`
*   **L3 SWEAP:** `psp_swp_spc_l3i_...`

## Usage

### Training / Fine-Tuning
To train the model on your own events or fine-tune on a new encounter:

```bash
python train_silversurfer.py
```

### Analysis
Running the model, with the saved weights from training, will enable you to locate the switchbacks as detecter by the model and then analyze them however you please. The time stamps can be made universal to locate the events in other measurments

To convert model detections into a **Universal Timestamp**:

The model operates on a synchronized 14.5 Hz grid. To find the exact Universal Time (UTC) of an event, you must map the detection's **Window Index** back to the `T_final` array generated by the data loader.

**The Formula:**
> **Start Time (UTC)** = `T_final[ Window_Index * Stride ]`

Where `Window_Index` is the position of the detection in the model's output array, and `Stride` is the sliding window step size (fixed at 64). This yields the exact datetime down to the nanosecond.

Additionally, the marked events are the edges of a switchback, and do not contain the entire event. 

## Citation
If you use this code in your research, please cite:
> [Oliver Altindag, "SilverSurfer: A Wavelet-Based Deep Learning Architecture for Magnetic Switchback Detection" (In Prep, 2026).]
